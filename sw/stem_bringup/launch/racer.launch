<launch>
    <arg name="map_size_x" default="5"/>
    <arg name="map_size_y" default="5"/>
    <arg name="map_size_z" default="1.7"/>
    <arg name="odometry_topic" default="mavros/local_position/odom" />
    <arg name="depth_topic" default="iris_depth_camera/camera/depth/image_raw"/>
    <arg name="sensor_pose_topic" default="drone_0/camera"/>
    <arg name="init_x" default="1"/>
    <arg name="init_y" default="1"/>
    <arg name="init_z" default="1"/> 
    <arg name="sim" default="false"/> 
    <arg name="sim_name" default="'sitl'"/> 

    <node name="tf_world_map" pkg="tf" type="static_transform_publisher" args="0 0 0 0 0 0 1 map world 10)"/>
    <node name="tf_base_cam" pkg="tf" type="static_transform_publisher" args="0.065 0 0.065 -0.5 0.5 -0.5 0.5 odom camera_link 10"/>

    <node if="$(eval sim_name=='perfect')" pkg ="map_generator" name ="map_pub" type ="map_pub" output = "screen" args="$(find map_generator)/resource/pillar.pcd">    
    </node>

    <!-- Planner -->
    <include file="$(find exploration_manager)/launch/single_drone_exploration.xml">
        <arg name="init_x"   value="$(arg init_x)"/>
        <arg name="init_y"   value="$(arg init_y)"/>
        <arg name="init_z"   value="$(arg init_z)"/> 
        <arg name="map_size_x" value="$(arg map_size_x)"/>
        <arg name="map_size_y" value="$(arg map_size_y)"/>
        <arg name="map_size_z" value="$(arg map_size_z)"/>
        <arg name="odom_prefix" value="/state_ukf/odom"/>
        <arg name="odometry_topic" value="$(arg odometry_topic)"/>
        <arg name="depth_topic" value="$(arg depth_topic)"/>
        <arg name="sensor_pose_topic" value="$(arg sensor_pose_topic)"/>
        <arg name="drone_id" value="1"/>
        <arg name="drone_num" value="3"/>
        <!-- Used to activate default racer perfect odometry simulator -->
        <arg name="simulation" value="$(eval sim_name=='perfect')"/>

        <!-- Got these from gazebo camera info topic -->
        <arg if="$(eval sim_name=='sitl' and sim)" name="cx" value="424.5"/>
        <arg if="$(eval sim_name=='sitl' and sim)" name="cy" value="240.5"/>
        <arg if="$(eval sim_name=='sitl' and sim)" name="fx" value="454.68577"/>
        <arg if="$(eval sim_name=='sitl' and sim)" name="fy" value="454.68577"/>
        
        <!-- Got these from realsense topic: /camera/depth/camera_info -->
        <arg unless="$(arg sim)" name="cx" value="422.865783"/>
        <arg unless="$(arg sim)" name="cy" value="242.46154"/>
        <arg unless="$(arg sim)" name="fx" value="427.75729"/>
        <arg unless="$(arg sim)" name="fy" value="427.75729"/>

        
      </include>
    
</launch>