<launch>
    <arg name="init_x"   default="0"/>
    <arg name="init_y"   default="0"/>
    <arg name="init_z"   default="0.1"/> 
    <arg name="init_R"   default="0"/>
    <arg name="init_P"   default="0"/>
    <arg name="init_Y"   default="0"/> 
    
    <arg name="gui" default="false" />
    <arg name="world" default="/root/.gazebo/experiment3.world"/>
    <arg name="vehicle" default="iris_depth_camera"/>
    <arg name="sim" default="true"/>
    <arg name="planner" default="racer"/>

    <param name="sim" value="$(arg sim)"/>

    <!-- firmware -->
    <include if="$(arg sim)" file="$(find px4_tools)/launch/px4_tools.launch">
        <arg name="sim"   value="$(arg sim)"/>
        <arg if="$(arg sim)" name="x"   value="$(arg init_x)"/>
        <arg if="$(arg sim)" name="y"   value="$(arg init_y)"/>
        <arg if="$(arg sim)" name="z"   value="$(arg init_z)"/> 
        <arg if="$(arg sim)" name="R"   value="$(arg init_R)"/>
        <arg if="$(arg sim)" name="P"   value="$(arg init_P)"/>
        <arg if="$(arg sim)" name="Y"   value="$(arg init_Y)"/> 
        <arg if="$(arg sim)" name="gui"   value="$(arg gui)"/> 
        <arg if="$(arg sim)" name="world" value="$(arg world)"/>
        <arg name="vehicle" value="$(arg vehicle)"/>
        <arg name="px4_control_interface_param_file" value="$(find planner)/config/racer.yaml"/>
    </include>

    <!-- Planner -->

    <include if="$(eval arg('planner') == 'racer')" file="$(find planner)/launch/racer.launch">
        <arg name="init_x"   value="$(arg init_x)"/>
        <arg name="init_y"   value="$(arg init_y)"/>
        <arg name="init_z"   value="$(arg init_z)"/>
        <arg name="sim"   value="$(arg sim)"/>
        <arg if="$(arg sim)" name="depth_topic" value="iris_depth_camera/camera/depth/image_raw"/> 
        <arg unless="$(arg sim)" name="depth_topic" value="camera/depth/image_rect_raw"/> 

        <arg name="odometry_topic" value="mavros/local_position/odom"/>
        <arg name="sensor_pose_topic" value="camera/pose"/>
    </include>
    
    <!-- planner-simulator interface -->
    <node name="planner_if" type="$(arg planner)_if.py" pkg="planner" output="screen"/>

</launch>